#!/usr/bin/env sh
set -u

SCRIPT_DIR=$(CDPATH= cd -- "$(dirname -- "$0")" && pwd)
BIN_PATH="$SCRIPT_DIR/../dist/vibecord"

if [ ! -x "$BIN_PATH" ]; then
  echo "vibecord binary is missing at $BIN_PATH." >&2
  echo "Reinstall the package or run: npm run build:binary" >&2
  exit 1
fi

"$BIN_PATH" "$@"
STATUS=$?

if [ "$STATUS" -eq 126 ]; then
  echo "vibecord binary could not execute (likely platform/architecture mismatch)." >&2
  echo "Rebuild with VIBECORD_BINARY_TARGET for your platform before publishing." >&2
fi

exit "$STATUS"
